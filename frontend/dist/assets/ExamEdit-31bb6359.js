import{_ as M,r as g,o as T,n,p as t,u as y,t as E,y as i,z as m,F as _,q as b,ad as L,B as R,i as C,m as d,ae as k,v as N}from"./Open-76f571e9.js";import{u as Q,a as x}from"./main-d489af6d.js";import"./index-7291c1ca.js";const O={name:"ExamEdit",setup(){const f=L(),e=R(),p=Q(),s=C("getRequest"),h=C("putRequest"),w=C("patchRequest"),o=g(!0),c=g(null),l=g({examInfo:{title:"",description:"",courseName:"",courseCode:"",examCode:"",totalMarks:0,timeLimit:0},questions:[]}),u=async()=>{try{o.value=!0;const a=await s({...x.getExam,url:x.getExam.url.replace(":id",f.params.id)});if(console.log("Response:",a),a.error)p.error(a.message||"Failed To load Exam");else{const r=a.item;console.log("Fetched data:",r),l.value={examInfo:{title:r.title,description:r.description,courseName:r.courseName,courseCode:r.courseCode,examCode:r.examCode,totalMarks:r.totalMarks,timeLimit:r.timeLimit},questions:r.questions}}}catch{p.error("Error fetching exam"),c.value="Failed to load exam",p.error("Failed to load exam")}finally{o.value=!1}},v=async()=>{try{const a=await h({...x.updateExam,url:x.updateExam.url.replace(":id",f.params.id),data:l.value});if(console.log("Response:",a),a.error){p.error(a.message||"Failed to save exam"),console.error("Error response:",a.message);return}p.success("Exam saved successfully"),e.push("/teacher/exams")}catch(a){console.error("Error saving exam:",a),p.error("Failed to save exam")}},V=async a=>{try{const r=await w({...x.updateExamStatus,url:x.updateExamStatus.url.replace(":id",f.params.id),data:{status:a}});return console.log("Status update response:",r),r.error?(p.error(r.message||"Failed to update exam status"),!1):(l.value.examInfo.status=a,p.success(`Exam ${a.toLowerCase()} successfully`),!0)}catch(r){return console.error("Error updating exam status:",r),p.error("Failed to update exam status"),!1}},U=async()=>{await V("PUBLISHED")&&e.push("/teacher/exams")},D=()=>{l.value.questions.push({text:"",type:"multiple-choice",options:["",""],correctAnswer:0,weight:1})},I=a=>{l.value.questions.splice(a,1)},A=a=>{a.options||(a.options=[]),a.options.push("")},F=(a,r)=>{a.options.splice(r,1),a.correctAnswer>=r&&(a.correctAnswer=Math.max(0,a.correctAnswer-1))};return T(()=>{f.params.id?u():o.value=!1}),{loading:o,error:c,examData:l,saveExam:v,addQuestion:D,removeQuestion:I,addOption:A,removeOption:F,publishExam:U}}},S={class:"exam-edit-container"},B={class:"header"},j={class:"actions"},z={key:0,class:"loading-state"},H={key:1,class:"error-state"},P={key:2,class:"exam-form"},W={class:"form-section"},G={class:"form-grid"},J={class:"form-group"},K={class:"form-group"},X={class:"form-group"},Y={class:"form-group"},Z={class:"form-group"},q={class:"form-group"},$={class:"form-group"},ee={class:"form-section"},te={class:"section-header"},oe={class:"question-header"},se=["onClick"],ae={class:"form-grid"},le={class:"form-group full-width"},re=["onUpdate:modelValue"],ne={class:"form-group"},ie=["onUpdate:modelValue"],de={class:"form-group"},ue=["onUpdate:modelValue"],me={key:0,class:"form-group full-width"},pe=["onUpdate:modelValue","placeholder"],ce=["onClick"],xe=["onClick"],fe={class:"form-group"},ve={key:0},ge=["onUpdate:modelValue"],ye=["value"],Ee={key:1},_e=["onUpdate:modelValue"],be={key:2},Ce=["onUpdate:modelValue"];function ke(f,e,p,s,h,w){return d(),n("div",S,[t("div",B,[e[10]||(e[10]=t("h2",null,"Edit Exam",-1)),t("div",j,[t("button",{class:"save-btn",onClick:e[0]||(e[0]=(...o)=>s.saveExam&&s.saveExam(...o))},[...e[9]||(e[9]=[t("i",{class:"fas fa-save"},null,-1),y(" Save Changes ",-1)])])])]),s.loading?(d(),n("div",z,[...e[11]||(e[11]=[t("div",{class:"spinner"},null,-1),t("span",null,"Loading exam...",-1)])])):s.error?(d(),n("div",H,E(s.error),1)):(d(),n("div",P,[t("div",W,[e[19]||(e[19]=t("h3",null,"Exam Information",-1)),t("div",G,[t("div",J,[e[12]||(e[12]=t("label",null,"Title",-1)),i(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>s.examData.examInfo.title=o),type:"text",placeholder:"Enter exam title"},null,512),[[m,s.examData.examInfo.title]])]),t("div",K,[e[13]||(e[13]=t("label",null,"Description",-1)),i(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.examData.examInfo.description=o),placeholder:"Enter exam description"},null,512),[[m,s.examData.examInfo.description]])]),t("div",X,[e[14]||(e[14]=t("label",null,"Course Name",-1)),i(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>s.examData.examInfo.courseName=o),type:"text",placeholder:"Enter course name"},null,512),[[m,s.examData.examInfo.courseName]])]),t("div",Y,[e[15]||(e[15]=t("label",null,"Course Code",-1)),i(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>s.examData.examInfo.courseCode=o),type:"text",placeholder:"Enter course code"},null,512),[[m,s.examData.examInfo.courseCode]])]),t("div",Z,[e[16]||(e[16]=t("label",null,"Exam Code",-1)),i(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>s.examData.examInfo.examCode=o),type:"text",placeholder:"Enter exam code"},null,512),[[m,s.examData.examInfo.examCode]])]),t("div",q,[e[17]||(e[17]=t("label",null,"Total Marks",-1)),i(t("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>s.examData.examInfo.totalMarks=o),type:"number",min:"0"},null,512),[[m,s.examData.examInfo.totalMarks,void 0,{number:!0}]])]),t("div",$,[e[18]||(e[18]=t("label",null,"Time Limit (minutes)",-1)),i(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>s.examData.examInfo.timeLimit=o),type:"number",min:"0"},null,512),[[m,s.examData.examInfo.timeLimit,void 0,{number:!0}]])])])]),t("div",ee,[t("div",te,[e[21]||(e[21]=t("h3",null,"Questions",-1)),t("button",{class:"add-btn",onClick:e[8]||(e[8]=(...o)=>s.addQuestion&&s.addQuestion(...o))},[...e[20]||(e[20]=[t("i",{class:"fas fa-plus"},null,-1),y(" Add Question ",-1)])])]),(d(!0),n(_,null,b(s.examData.questions,(o,c)=>(d(),n("div",{key:c,class:"question-card"},[t("div",oe,[t("h4",null,"Question "+E(c+1),1),t("button",{class:"delete-btn",onClick:l=>s.removeQuestion(c)},[...e[22]||(e[22]=[t("i",{class:"fas fa-trash"},null,-1)])],8,se)]),t("div",ae,[t("div",le,[e[23]||(e[23]=t("label",null,"Question Text",-1)),i(t("textarea",{"onUpdate:modelValue":l=>o.text=l,placeholder:"Enter question text"},null,8,re),[[m,o.text]])]),t("div",ne,[e[25]||(e[25]=t("label",null,"Type",-1)),i(t("select",{"onUpdate:modelValue":l=>o.type=l},[...e[24]||(e[24]=[t("option",{value:"multiple-choice"},"Multiple Choice",-1),t("option",{value:"true-false"},"True/False",-1),t("option",{value:"short-answer"},"Short Answer",-1)])],8,ie),[[k,o.type]])]),t("div",de,[e[26]||(e[26]=t("label",null,"Weight",-1)),i(t("input",{"onUpdate:modelValue":l=>o.weight=l,type:"number",min:"0"},null,8,ue),[[m,o.weight,void 0,{number:!0}]])]),o.type==="multiple-choice"?(d(),n("div",me,[e[29]||(e[29]=t("label",null,"Options",-1)),(d(!0),n(_,null,b(o.options,(l,u)=>(d(),n("div",{key:u,class:"option-row"},[i(t("input",{"onUpdate:modelValue":v=>o.options[u]=v,type:"text",placeholder:"Option "+(u+1)},null,8,pe),[[m,o.options[u]]]),t("button",{class:"delete-btn small",onClick:v=>s.removeOption(o,u)},[...e[27]||(e[27]=[t("i",{class:"fas fa-times"},null,-1)])],8,ce)]))),128)),t("button",{class:"add-btn small",onClick:l=>s.addOption(o)},[...e[28]||(e[28]=[t("i",{class:"fas fa-plus"},null,-1),y(" Add Option ",-1)])],8,xe)])):N("",!0),t("div",fe,[e[31]||(e[31]=t("label",null,"Correct Answer",-1)),o.type==="multiple-choice"?(d(),n("div",ve,[i(t("select",{"onUpdate:modelValue":l=>o.correctAnswer=l},[(d(!0),n(_,null,b(o.options,(l,u)=>(d(),n("option",{key:u,value:u}," Option "+E(u+1),9,ye))),128))],8,ge),[[k,o.correctAnswer,void 0,{number:!0}]])])):o.type==="true-false"?(d(),n("div",Ee,[i(t("select",{"onUpdate:modelValue":l=>o.correctAnswer=l},[...e[30]||(e[30]=[t("option",{value:!0},"True",-1),t("option",{value:!1},"False",-1)])],8,_e),[[k,o.correctAnswer]])])):(d(),n("div",be,[i(t("input",{"onUpdate:modelValue":l=>o.correctAnswer=l,type:"text",placeholder:"Enter correct answer"},null,8,Ce),[[m,o.correctAnswer]])]))])])]))),128))])]))])}const Ue=M(O,[["render",ke],["__scopeId","data-v-b16fca93"]]);export{Ue as default};
